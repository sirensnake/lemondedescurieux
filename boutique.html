<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <title>Boutique Curio - Centre de R√©compenses</title>
    <link rel="stylesheet" href="styles/home-page.css">
    <link rel="stylesheet" href="styles/dashboard-global.css">
    <link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap" rel="stylesheet">
    
    <style>
        /* Styles sp√©cifiques aux onglets de la boutique */
        .tabs { display: flex; justify-content: center; gap: 10px; margin-bottom: 30px; }
        .tab-btn { 
            background: #34495e; color: white; border: 4px solid #000; 
            padding: 10px; font-family: 'Press Start 2P'; font-size: 8px; cursor: pointer;
            box-shadow: inset -4px -4px 0px 0px #2c3e50;
        }
        .tab-btn.active { background: #f1c40f; color: #000; box-shadow: none; }
        .locked { opacity: 0.5; filter: grayscale(1); }
    </style>
</head>
<body class="dashboard-page">

    <button class="menu-btn" onclick="window.location.href='index.html'">üè†</button>

    <div class="main-container">
        <header class="dashboard-header">
            <h1>‚ú® BOUTIQUE CURIO</h1>
            <p class="stat-val">OR : <span id="xp-count">0</span> ‚≠ê</p>
        </header>

        <nav class="tabs">
            <button class="tab-btn active" onclick="filterShop('avatar', event)">AVATARS</button>
            <button class="tab-btn" onclick="filterShop('equip', event)">OBJETS</button>
            <button class="tab-btn" onclick="filterShop('title', event)">TITRES</button>
        </nav>

        <div class="grid stats-grid" id="rewards-grid">
            </div>
    </div>

    <script>
        // Catalogue d'objets
        const rewards = [
            { id: 1, cat: 'avatar', name: "Renard", emoji: "ü¶ä", price: 0 },
            { id: 2, cat: 'avatar', name: "Chat", emoji: "üê±", price: 100 },
            { id: 3, cat: 'avatar', name: "Robot", emoji: "ü§ñ", price: 300 },
            { id: 4, cat: 'equip',  name: "√âp√©e", emoji: "‚öîÔ∏è", price: 200 },
            { id: 5, cat: 'equip',  name: "Bouclier", emoji: "üõ°Ô∏è", price: 150 },
            { id: 6, cat: 'title',  name: "Ma√Ætre", emoji: "üéì", price: 500 }
        ];

        let currentCat = 'avatar';

        function render() {
            const xp = parseInt(localStorage.getItem('curio_xp')) || 0;
            const purchased = JSON.parse(localStorage.getItem('curio_badges')) || [];
            document.getElementById('xp-count').innerText = xp;
            
            const grid = document.getElementById('rewards-grid');
            grid.innerHTML = rewards
                .filter(r => r.cat === currentCat)
                .map(r => {
                    const isOwned = purchased.includes(r.emoji);
                    const isLocked = xp < r.price && !isOwned;
                    
                    return `
                    <div class="card-pixel ${isLocked ? 'locked' : ''}" onclick="processPurchase('${r.emoji}', ${r.price})">
                        <div class="badge-emoji">${r.emoji}</div>
                        <div style="font-size: 8px; margin-top:15px; color: #bdc3c7;">${r.name}</div>
                        <div class="stat-val" style="font-size: 10px; margin-top:10px;">
                            ${isOwned ? 'ACQUIS' : r.price + ' XP'}
                        </div>
                    </div>`;
                }).join('');
        }

        function filterShop(cat, event) {
            currentCat = cat;
            document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
            event.target.classList.add('active');
            render();
        }

        window.processPurchase = (emoji, price) => {
            let xp = parseInt(localStorage.getItem('curio_xp')) || 0;
            let purchased = JSON.parse(localStorage.getItem('curio_badges')) || [];

            if (purchased.includes(emoji)) {
                alert("Tu poss√®des d√©j√† cet objet !");
                return;
            }

            if (xp >= price) {
                if(confirm(`Voulez-vous d√©bloquer ${emoji} pour ${price} XP ?`)) {
                    xp -= price;
                    purchased.push(emoji);
                    localStorage.setItem('curio_xp', xp);
                    localStorage.setItem('curio_badges', JSON.stringify(purchased));
                    render();
                }
            } else {
                alert("Il te manque des XP ! Continue tes missions.");
            }
        };

        render();
    </script>
</body>
</html>