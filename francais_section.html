<!DOCTYPE html>
<html lang="fr">
<!-- Header avec contrÃ´le utilisateur intÃ©grÃ© -->
<header class="section-header-styled [section]">
    <div class="header-container">
        <!-- Navigation retour -->
        <button onclick="history.back()" class="back-btn-minecraft [section]">
            â† Retour
        </button>
        
        <!-- ContrÃ´le utilisateur (nouveau) -->
        <div id="user-control" class="user-control-container">
            <!-- Ã‰tat non connectÃ© -->
            <div id="user-guest" class="user-guest">
                <button onclick="userController.showProfileSetup()" class="btn-profile-setup">
                    ğŸ‘¤ CrÃ©er mon profil
                </button>
            </div>
            
            <!-- Ã‰tat connectÃ© -->
            <div id="user-connected" class="user-connected" style="display: none;">
                <div class="user-avatar" onclick="userController.toggleMenu()">
                    <img id="user-avatar-img" src="images/avatars/curio-default.png" alt="Avatar">
                    <span id="user-nickname">Explorateur</span>
                </div>
                
                <!-- Menu dÃ©roulant utilisateur -->
                <div id="user-menu" class="user-dropdown-menu" style="display: none;">
                    <div class="user-menu-header">
                        <strong id="menu-nickname">Explorateur</strong>
                        <span class="user-level">Niveau <span id="menu-level">1</span></span>
                    </div>
                    
                    <div class="user-menu-stats">
                        <div class="stat-item">
                            <span class="stat-icon">ğŸ”¥</span>
                            <span class="stat-value" id="menu-streak">0</span>
                            <span class="stat-label">jours</span>
                        </div>
                        <div class="stat-item">
                            <span class="stat-icon">â­</span>
                            <span class="stat-value" id="menu-xp">0</span>
                            <span class="stat-label">XP</span>
                        </div>
                        <div class="stat-item">
                            <span class="stat-icon">ğŸ†</span>
                            <span class="stat-value" id="menu-badges">0</span>
                            <span class="stat-label">badges</span>
                        </div>
                    </div>
                    
                    <ul class="user-menu-actions">
                        <li><a href="mon-parcours.html">ğŸ“Š Mon Tableau de Bord</a></li>
                        <li><a href="#" onclick="userController.editProfile()">âœï¸ Modifier Profil</a></li>
                        <li><a href="#" onclick="userController.exportData()">ğŸ’¾ Exporter DonnÃ©es</a></li>
                        <li><a href="#" onclick="userController.showSettings()">âš™ï¸ ParamÃ¨tres</a></li>
                        <li class="divider"></li>
                        <li><a href="#" onclick="userController.resetProfile()" class="danger">ğŸ”„ RÃ©initialiser</a></li>
                    </ul>
                </div>
            </div>
        </div>
    </div>
</header>
<body class="francais-section">
    <!-- Header stylisÃ© avec composant -->
    <header class="section-header-styled francais">
        <nav aria-label="Fil d'Ariane" class="breadcrumb-minecraft">
    <ol>
        <li><a href="index.html">ğŸ  Accueil</a></li>
        <li><a href="langues.html">ğŸŒ Langues</a></li>
        <li aria-current="page">ğŸ‡¬ğŸ‡§ Anglais</li>
    </ol>
</nav>
    </header>

    <main>
        <!-- Fil d'Ariane -->
        <div class="breadcrumb" aria-label="Fil d'Ariane">
            ğŸ  <a href="index.html">Accueil</a> > ğŸ‡«ğŸ‡· FranÃ§ais
        </div>
        
        <!-- Menu latÃ©ral simple et fonctionnel -->
        <button class="sidebar-toggle" aria-label="Ouvrir / fermer le menu">â˜°</button>
        <div class="sidebar">
            <ul>
                <li><a href="index.html">Accueil</a></li>
                <li><a href="maths_section.html">MathÃ©matiques</a></li>
                <li><a href="sciences_section.html">Sciences</a></li>
                <li><a href="histoire_section.html">Histoire-GÃ©o</a></li>
                <li><a href="francais_section.html">FranÃ§ais</a></li>
                <li><a href="english_section.html">English</a></li>
                <li><a href="programmation_section.html">Programmation</a></li>
                <li><a href="echecs_section.html">Ã‰checs</a></li>
                <li><a href="philosophie_section.html">Philosophie</a></li>
                <li><a href="ressources_section.html">Ressources</a></li>
                <li><a href="infos_section.html">Infos</a></li>
                <li><a href="ia_section.html">IA</a></li>
                <li><a href="mon-parcours.html">Mon Parcours</a></li>
            </ul>
        </div>

        <!-- Zone XP automatique -->
        <div id="xp-status" style="text-align: center; margin: 1rem 0; padding: 1rem; background: #f1faee; border-radius: 8px; display: none;">
            <span id="xp-display">XP: 0</span> | 
            <span id="hearts-display">â¤ï¸â¤ï¸â¤ï¸â¤ï¸â¤ï¸</span> | 
            <span id="streak-display">ğŸ”¥ 0 jours</span>
        </div>

        <!-- Outils d'accessibilitÃ© -->
        <div class="accessibility-tools">
            <button class="accessibility-button" id="text-size-toggle" title="Changer la taille du texte" aria-label="Agrandir le texte">A</button>
            <button class="accessibility-button" id="contrast-toggle" title="Changer le contraste" aria-label="Mode contraste Ã©levÃ©">C</button>
            <button class="accessibility-button" id="dark-mode-toggle" title="Mode sombre" aria-label="Activer/dÃ©sactiver le mode sombre">ğŸŒ™</button>
        </div>

        <!-- Titre section -->
        <div class="section-title">
            <h1>ğŸ‡«ğŸ‡· FranÃ§ais</h1>
            <p>MaÃ®trise la langue franÃ§aise avec Curio !</p>
        </div>

        <!-- ActivitÃ©s Interactives SIMPLIFIÃ‰ES -->
        <section>
            <h2>ğŸ® ActivitÃ©s Interactives</h2>
            
            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 1rem; margin: 2rem 0;">
                
                <button id="grammaire-btn" class="activity-btn" data-activity="grammaire" data-xp="20">
                    ğŸ“ Quiz Grammaire<br>
                    <small style="font-size: 8px; opacity: 0.9;">+20 XP</small>
                </button>

                <button id="conjugaison-btn" class="activity-btn" data-activity="conjugaison" data-xp="25">
                    ğŸ”„ Conjugaison<br>
                    <small style="font-size: 8px; opacity: 0.9;">+25 XP</small>
                </button>

                <button id="dictee-btn" class="activity-btn" data-activity="dictee" data-xp="30">
                    ğŸ§ DictÃ©e Interactive<br>
                    <small style="font-size: 8px; opacity: 0.9;">+30 XP</small>
                </button>

                <button id="vocabulaire-btn" class="activity-btn" data-activity="vocabulaire" data-xp="15">
                    ğŸ“š Vocabulaire<br>
                    <small style="font-size: 8px; opacity: 0.9;">+15 XP</small>
                </button>
            </div>
        </section>

        <!-- Zone quiz avec ID existant -->
        <section>
            <h2>ğŸ§  Zone Quiz</h2>
            <div id="quiz-container" style="text-align: center; padding: 2rem;">
                <div style="background: #f1faee; padding: 2rem; border-radius: 12px; box-shadow: 0 4px 8px rgba(0,0,0,0.1);">
                    <p style="color: #264653; margin-bottom: 1rem;">Choisis une activitÃ© ci-dessus pour commencer !</p>
                    <p style="color: #2a9d8f; font-size: 12px;">Les quiz s'afficheront ici...</p>
                </div>
            </div>
        </section>
    </main>

    <!-- Scripts dans l'ordre CORRECT -->
    <script src="scripts/general_script.js"></script>
    <script src="scripts/xp_system_complete.js"></script>
    <script src="scripts/accessibilite.js"></script>
    <script src="scripts/menu_enhanced.js"></script>
    
    <!-- Scripts quiz AVANT francais_complete.js -->
    <script src="scripts/quiz_grammaire_cm1.js"></script>
    <script src="scripts/quiz_conjugaison_cm1.js"></script>
    
    <!-- Script principal EN DERNIER -->
    <script src="scripts/francais_complete.js"></script>
    
    <style>
        /* Styles des boutons d'activitÃ© */
        .activity-btn {
            background: linear-gradient(135deg, #2a9d8f, #e9c46a);
            color: white;
            border: none;
            padding: 2rem 1rem;
            border-radius: 12px;
            cursor: pointer;
            font-family: 'Press Start 2P', monospace;
            font-size: 12px;
            text-align: center;
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
            transition: transform 0.3s;
        }
        
        .activity-btn:hover {
            transform: translateY(-5px);
        }
        
        .activity-btn:active {
            transform: translateY(-2px);
        }
        
        #conjugaison-btn {
            background: linear-gradient(135deg, #e76f51, #f4a261);
        }
        
        #dictee-btn {
            background: linear-gradient(135deg, #264653, #2a9d8f);
        }
        
        #vocabulaire-btn {
            background: linear-gradient(135deg, #457b9d, #1d3557);
        }
    </style>
    
    <script>
        // Initialisation SIMPLIFIÃ‰E et ROBUSTE
        document.addEventListener("DOMContentLoaded", function() {
            console.log("ğŸ”§ Initialisation section FranÃ§ais...");
            
            // 1. Menu latÃ©ral
            initMenuLateral();
            
            // 2. Attendre que tous les scripts soient chargÃ©s
            setTimeout(() => {
                // 3. SystÃ¨mes XP
                initXPSystems();
                
                // 4. Ã‰vÃ©nements activitÃ©s
                initActivityButtons();
                
                console.log("âœ… Section FranÃ§ais initialisÃ©e avec succÃ¨s !");
            }, 1500); // DÃ©lai plus long pour assurer chargement complet
        });
        
        function initMenuLateral() {
            const sidebar = document.querySelector('.sidebar');
            const toggleButton = document.querySelector('.sidebar-toggle');
            
            if (sidebar) sidebar.style.left = '-250px';
            
            if (toggleButton && sidebar) {
                toggleButton.addEventListener('click', function(e) {
                    e.preventDefault();
                    sidebar.style.left = sidebar.style.left === '0px' ? '-250px' : '0px';
                });
                
                document.addEventListener('click', function(e) {
                    if (sidebar.style.left === '0px' && 
                        e.target !== toggleButton && 
                        !sidebar.contains(e.target)) {
                        sidebar.style.left = '-250px';
                    }
                });
            }
        }
        
        function initXPSystems() {
            try {
                if (window.xpManager) {
                    window.xpManager.currentSection = 'francais';
                    document.getElementById('xp-status').style.display = 'block';
                    updateDisplays();
                    console.log("âœ… SystÃ¨mes XP initialisÃ©s");
                }
            } catch (e) {
                console.warn("âš ï¸ Erreur systÃ¨mes XP:", e);
            }
        }
        
        function initActivityButtons() {
            const buttons = document.querySelectorAll('.activity-btn');
            buttons.forEach(btn => {
                btn.addEventListener('click', function() {
                    const activity = this.dataset.activity;
                    const xp = parseInt(this.dataset.xp);
                    
                    console.log(`ğŸ® ActivitÃ© lancÃ©e: ${activity} (+${xp} XP)`);
                    
                    // VÃ©rifier que francaisComplete existe
                    if (typeof francaisComplete !== 'undefined') {
                        if (typeof window.startActivity === 'function') {
                            window.startActivity(activity, xp);
                        } else {
                            console.error("âŒ Fonction startActivity non trouvÃ©e");
                            showError("SystÃ¨me non initialisÃ©");
                        }
                    } else {
                        console.error("âŒ francaisComplete non trouvÃ©");
                        showError("Scripts non chargÃ©s");
                    }
                });
            });
            
            console.log("âœ… Boutons d'activitÃ© initialisÃ©s");
        }
        
        function updateDisplays() {
            try {
                if (window.xpManager) {
                    document.getElementById('xp-display').textContent = `XP: ${window.xpManager.xpData.currentXP}`;
                }
                if (window.heartSystem) {
                    const hearts = 'â¤ï¸'.repeat(window.heartSystem.heartsData.currentHearts) + 
                                 'ğŸ¤'.repeat(5 - window.heartSystem.heartsData.currentHearts);
                    document.getElementById('hearts-display').textContent = hearts;
                }
                if (window.streakManager) {
                    document.getElementById('streak-display').textContent = `ğŸ”¥ ${window.streakManager.streakData.currentStreak} jours`;
                }
            } catch (e) {
                console.warn('âš ï¸ Erreur mise Ã  jour affichage:', e);
            }
        }
        
        function showError(message) {
            const container = document.getElementById('quiz-container');
            if (container) {
                container.innerHTML = `
                    <div style="background: #ffebee; padding: 2rem; border-radius: 12px; text-align: center;">
                        <div style="font-size: 3rem; margin-bottom: 1rem;">âš ï¸</div>
                        <h3 style="color: #c62828; margin-bottom: 1rem;">Erreur Technique</h3>
                        <p style="color: #d32f2f; margin-bottom: 2rem;">${message}</p>
                        <button onclick="location.reload()" style="
                            background: #1976d2;
                            color: white;
                            border: none;
                            padding: 1rem 2rem;
                            border-radius: 8px;
                            cursor: pointer;
                        ">
                            ğŸ”„ Recharger la page
                        </button>
                    </div>
                `;
            }
        }
        
        // Fonction globale pour debug
        window.debugFrancais = function() {
            console.log("ğŸ” DEBUG Section FranÃ§ais:");
            console.log("- francaisComplete:", typeof francaisComplete);
            console.log("- grammaireQuiz:", typeof grammaireQuiz);
            console.log("- conjugaisonQuiz:", typeof conjugaisonQuiz);
            console.log("- startActivity:", typeof window.startActivity);
            console.log("- xpManager:", typeof window.xpManager);
            console.log("- heartSystem:", typeof window.heartSystem);
            console.log("- streakManager:", typeof window.streakManager);
        };
    </script>
    <script src="./scripts/xp_system_complete.js"></script>
</body>
</html>